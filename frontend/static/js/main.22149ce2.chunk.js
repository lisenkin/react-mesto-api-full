(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{20:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(22),o=n.n(c),r=n(8),i=(n(20),n(24)),u=n(15),l=n(2),p=s.a.createContext(),d=n.p+"static/media/Vector.03b78ada.svg",j=n(3),m=n(0);var b=function(e){var t=Object(j.h)();return Object(m.jsxs)("header",{className:"header page__header",children:[Object(m.jsx)("img",{src:d,alt:"mesto logo",className:"logo"}),"/"===t.pathname&&Object(m.jsxs)("div",{className:"header__block",children:[Object(m.jsx)("p",{className:"header__email",children:e.email}),Object(m.jsx)("a",{className:"header__link",onClick:e.onSignout,children:"\u0412\u044b\u0439\u0442\u0438"})]}),"/sign-up"===t.pathname&&Object(m.jsx)(r.b,{to:"/sign-in",className:"header__link",children:"\u0412\u043e\u0439\u0442\u0438"}),"/sign-in"===t.pathname&&Object(m.jsx)(r.b,{to:"/sign-up",className:"header__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})};var _=function(){return Object(m.jsx)("footer",{className:"footer page__footer",children:Object(m.jsx)("p",{className:"footer__author",children:"\xa9 2021 Mesto Russia lisenkin"})})};var h=function(e){var t=Object(a.useContext)(p),n=e.card.owner._id===t._id?Object(m.jsx)("button",{className:"place__button-remove",type:"button",onClick:function(){e.onCardDelete(e.card)}}):null,s=e.card.likes.some((function(e){return e._id===t._id})),c="place__like ".concat(s?"places__like_active":"");return Object(m.jsxs)("article",{className:"place",children:[Object(m.jsx)("img",{className:"place__photo",alt:e.card.name,src:e.card.link,onClick:function(){e.handleClick(e.card)}}),n,Object(m.jsxs)("div",{className:"place__textarea",children:[Object(m.jsx)("h2",{className:"place__text",children:e.card.name}),Object(m.jsxs)("div",{className:"place__column-block",children:[Object(m.jsx)("button",{className:c,type:"button",onClick:function(){e.onCardLike(e.card)}}),Object(m.jsx)("span",{className:"place__score-like",children:e.card.likes.length})]})]})]})};var O=function(e){var t=Object(a.useContext)(p);return Object(m.jsxs)("main",{className:"page__content content",children:[Object(m.jsxs)("section",{className:"page__profile profile",children:[Object(m.jsx)("div",{className:"profile__overlay",onClick:e.onEditAvatar,children:Object(m.jsx)("img",{src:t.avatar,alt:e.altAvatar,className:"profile__avatar"})}),Object(m.jsxs)("div",{className:"profile__info",children:[Object(m.jsxs)("div",{className:"profile__info-textblock",children:[Object(m.jsx)("h1",{className:"profile__name",children:t.name}),Object(m.jsx)("button",{className:"profile__button-edit",type:"button",onClick:e.onEditProfile})]}),Object(m.jsx)("p",{className:"profile__status",children:t.about})]}),Object(m.jsx)("button",{className:"profile__button-add",type:"button",onClick:e.onAddPlace})]}),Object(m.jsx)("section",{className:"page__places places"}),e.isLoading?Object(m.jsx)("p",{children:"Loading..."}):Object(m.jsx)("section",{className:"places__list page__places places",children:e.cards.map((function(t){return Object(m.jsx)(h,{card:t,handleClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})},f=n.p+"static/media/Close_Icon.61b629a4.svg";var x=function(e){return Object(m.jsx)("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen&&"popup_visible"),children:Object(m.jsxs)("div",{className:"popup__content",children:[Object(m.jsx)("img",{src:f,alt:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close-button",onClick:e.onClose}),Object(m.jsx)("h3",{className:"popup__title",children:e.title}),Object(m.jsxs)("form",{className:"popup__form",name:e.name,onSubmit:e.onSubmit,children:[e.children,Object(m.jsx)("button",{className:"button popup__button-submit",type:"submit",children:e.textButton})]})]})})};var g=function(e){var t="popup popup_dark ".concat(e.card.isOpen?"popup_visible":"");return Object(m.jsx)("section",{className:t,id:"popup-image",children:Object(m.jsxs)("figure",{className:"popup__figure",children:[Object(m.jsx)("button",{className:"button popup__close-button",type:"button",onClick:e.onClose}),Object(m.jsx)("img",{className:"popup__image",src:e.card.link,alt:e.card.name}),Object(m.jsx)("figcaption",{className:"popup__caption",children:e.card.name})]})})};var v=function(e){var t=Object(a.useContext)(p),n=Object(a.useState)(t.name),s=Object(l.a)(n,2),c=s[0],o=s[1],r=Object(a.useState)(t.about),i=Object(l.a)(r,2),u=i[0],d=i[1];return Object(a.useEffect)((function(){o(t.name),d(t.about)}),[t,e.isOpen]),Object(m.jsxs)(x,{name:"popup-edit-card",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",textButton:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:u})},children:[Object(m.jsx)("input",{className:"popup__input popup__input_type_name",type:"text",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",name:"popup-input-name",minLength:"2",maxLength:"40",value:c,onChange:function(e){o(e.target.value)},required:!0}),Object(m.jsx)("span",{className:"popup__error popup-input-name-error"}),Object(m.jsx)("input",{className:"popup__input popup__input_type_status",type:"text",placeholder:"\u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438\u0442\u0435 \u043e \u0441\u0435\u0431\u0435",name:"popup-input-status",minLength:"2",maxLength:"200",value:u,onChange:function(e){d(e.target.value)},required:!0}),Object(m.jsx)("span",{className:"popup__error popup-input-status-error"})]})};var N=function(e){Object(a.useContext)(p);var t=Object(a.useState)(""),n=Object(l.a)(t,2),s=n[0],c=n[1];return Object(m.jsxs)(x,{name:"popup-add-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",textButton:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar({avatar:s})},children:[Object(m.jsx)("input",{className:"popup__input popup__input_type_photo",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",name:"popup-input-url-avatar",value:s||"",onChange:function(e){c(e.target.value)},required:!0}),Object(m.jsx)("span",{className:"popup__error popup-input-url-avatar-error"})]})};var C=function(e){var t=Object(a.useRef)(),n=Object(a.useRef)();return Object(m.jsxs)(x,{name:"popup-add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",textButton:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onAddPlace({name:t.current.value,link:n.current.value}),t.current.value="",n.current.value=""},children:[Object(m.jsx)("input",{className:"popup__input popup__input_type_place-name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"popup-input-place-name",minLength:"2",maxLength:"30",ref:t,required:!0}),Object(m.jsx)("span",{className:"popup__error popup-input-place-name-error"}),Object(m.jsx)("input",{className:"popup__input popup__input_type_photo",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"popup-input-url",ref:n,required:!0}),Object(m.jsx)("span",{className:"popup__error popup-input-url-error"})]})},k=n(13),y=n(14),S=new(function(){function e(t){var n=t.baseUrl,a=t.headers,s=t.credentials;Object(k.a)(this,e),this._headers=a,this._baseUrl=n,this._credentials=s}return Object(y.a)(e,[{key:"getCards",value:function(){return this._sendRequest("/cards","GET")}},{key:"getUserData",value:function(){return this._sendRequest("/users/me","GET")}},{key:"updateUserData",value:function(e){return this._sendRequest("/users/me","PATCH",e)}},{key:"toggleCardLike",value:function(e,t){return t?this._sendRequest("/cards/".concat(e,"/likes"),"PUT"):this._sendRequest("/cards/".concat(e,"/likes"),"DELETE")}},{key:"addNewCard",value:function(e){return this._sendRequest("/cards","POST",e)}},{key:"deleteCard",value:function(e){return this._sendRequest("/cards/".concat(e),"DELETE")}},{key:"updateUserAvatar",value:function(e){return this._sendRequest("/users/me/avatar","PATCH",e)}},{key:"_sendRequest",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._headers,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._credentials,c={method:t,headers:a,credentials:s};return n&&(c.body=JSON.stringify(n)),fetch("".concat(this._baseUrl).concat(e),c).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status," ").concat(e.statusText))}))}}]),e}())({baseUrl:"https://api.mesto.lisena.nomoredomains.monster",credentials:"include",headers:{"Content-Type":"application/json"}});var E=function(e){var t=s.a.useState(""),n=Object(l.a)(t,2),a=n[0],c=n[1],o=s.a.useState(""),r=Object(l.a)(o,2),i=r[0],u=r[1];function p(e){e.preventDefault(),"email"===e.target.name?c(e.target.value):"password"===e.target.name&&u(e.target.value)}return Object(m.jsx)("section",{className:"form",children:Object(m.jsxs)("div",{className:"form__content",children:[Object(m.jsx)("h2",{className:"form__title",children:"\u0412\u0445\u043e\u0434"}),Object(m.jsxs)("form",{className:"form__input",name:"form__input",onSubmit:function(t){t.preventDefault(),a&&i&&e.onLogin(a,i)},children:[Object(m.jsx)("input",{className:"form__email",id:"email",type:"email",placeholder:"Email",value:a,onChange:p,name:"email",required:!0}),Object(m.jsx)("span",{className:"form__email-error",id:"email-error"}),Object(m.jsx)("input",{className:"form__password",id:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:i,onChange:p,name:"password",required:!0}),Object(m.jsx)("span",{className:"form__password-error",id:"password-error"}),Object(m.jsx)("button",{className:"form__button",type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})};var L=function(e){var t=s.a.useState(""),n=Object(l.a)(t,2),a=n[0],c=n[1],o=s.a.useState(""),i=Object(l.a)(o,2),u=i[0],p=i[1];function d(e){e.preventDefault(),"email"===e.target.name?c(e.target.value):"password"===e.target.name&&p(e.target.value)}return Object(m.jsx)("section",{className:"form",children:Object(m.jsxs)("div",{className:"form__content",children:[Object(m.jsx)("h2",{className:"form__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(m.jsxs)("form",{className:"form__form",name:"form__form",onSubmit:function(t){t.preventDefault(),e.onRegister(a,u)},children:[Object(m.jsx)("input",{className:"form__email",type:"email",placeholder:"Email",value:a,onChange:d,name:"email",required:!0,minLength:"2",maxLength:"40"}),Object(m.jsx)("span",{className:"form__email-error",name:"email-error"}),Object(m.jsx)("input",{className:"form__password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:u,onChange:d,name:"password",required:!0,minLength:"2",maxLength:"40"}),Object(m.jsx)("span",{className:"form__password-error",name:"password-error"}),Object(m.jsx)("button",{className:"form__button",type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(m.jsxs)("div",{className:"form__signup",children:[Object(m.jsx)("p",{children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"}),Object(m.jsx)(r.b,{to:"/sign-in",className:"form__link",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})},U=n(25),q=["component"],w=function(e){var t=e.component,n=Object(U.a)(e,q);return Object(m.jsx)(j.b,{children:function(){return n.loggedIn?Object(m.jsx)(t,Object(u.a)({},n)):Object(m.jsx)(j.a,{to:"./sign-in"})}})},R=n.p+"static/media/fail.df8eddf6.svg",T=n.p+"static/media/success.1b6082f8.svg";var D=function(e){return Object(m.jsx)("section",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen&&"popup_visible"),children:Object(m.jsxs)("div",{className:"popup__content",children:[Object(m.jsx)("button",{className:"button popup__close-button",type:"button",onClick:e.onClose}),Object(m.jsxs)("div",{className:"popup__tooltip",children:[Object(m.jsx)("img",{className:"popup__tooltip-img",alt:"\u0443\u0441\u043f\u0435\u0445-\u043d\u0435-\u0443\u0441\u043f\u0435\u0445",src:e.success?T:R}),Object(m.jsx)("p",{className:"popup__tooltip-title",children:e.success?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."})]})]})})},P=new(function(){function e(t){var n=t.baseUrl,a=t.headers,s=t.credentials;Object(k.a)(this,e),this._headers=a,this._baseUrl=n,this._credentials=s}return Object(y.a)(e,[{key:"getLoginData",value:function(){return this._sendRequest("/users/me","GET",null)}},{key:"signUpUser",value:function(e){return this._sendRequest("/signup","POST",e)}},{key:"signInUser",value:function(e){return this._sendRequest("/signin","POST",e)}},{key:"signOutUser",value:function(){return this._sendRequest("/signout","GET",null)}},{key:"_sendRequest",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._headers,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._credentials,c={method:t,headers:a,credentials:s};return n&&(c.body=JSON.stringify(n)),fetch("".concat(this._baseUrl).concat(e),c).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status,": ").concat(e.statusText))}))}}]),e}())({baseUrl:"https://api.mesto.russia.nomoredomains.club",credentials:"include",headers:{"Content-Type":"application/json"}});var A=function(){var e=Object(a.useState)({name:"Loading...",about:""}),t=Object(l.a)(e,2),n=t[0],c=t[1],o=s.a.useState(!1),r=Object(l.a)(o,2),d=r[0],h=r[1],f=s.a.useState(!1),k=Object(l.a)(f,2),y=k[0],U=k[1],q=s.a.useState(!1),R=Object(l.a)(q,2),T=R[0],A=R[1],I=s.a.useState({isOpen:!1}),B=Object(l.a)(I,2),F=B[0],G=B[1],J=Object(a.useState)([]),H=Object(l.a)(J,2),M=H[0],z=H[1],V=s.a.useState(!1),K=Object(l.a)(V,2),Q=K[0],W=K[1],X=s.a.useState(""),Y=Object(l.a)(X,2),Z=Y[0],$=Y[1],ee=s.a.useState(!1),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],se=Object(j.g)(),ce=s.a.useState(!1),oe=Object(l.a)(ce,2),re=oe[0],ie=oe[1];function ue(){h(!1),U(!1),A(!1),G({isOpen:!1}),ae(!1)}return Object(a.useEffect)((function(){!function(){var e=localStorage.getItem("jwt");e&&P.checkToken(e).then((function(e){e?(W(!0),$(e.data.email),se.push("/")):(ie(!1),ae(!0))})).catch((function(e){console.error(e),ie(!1),ae(!0)}))}(),S.getInitialCards().then((function(e){z(e)})).catch((function(e){return console.log("Error: ".concat(e))}))}),[]),Object(a.useEffect)((function(){S.getUserInfo().then((function(e){c(e)})).catch((function(e){return console.log("Error: ".concat(e))}))}),[]),Object(m.jsx)("div",{className:"page__content",children:Object(m.jsxs)(p.Provider,{value:n,children:[Object(m.jsx)(b,{loggedIn:Q,email:Z,onSignout:function(){localStorage.removeItem("jwt"),$(""),W(!1),se.push("/sign-in")}}),Object(m.jsxs)(j.d,{children:[Object(m.jsx)(w,{exact:!0,path:"/",component:O,onEditAvatar:function(){A(!0)},onEditProfile:function(){h(!0)},onAddPlace:function(){U(!0)},onCardClick:function(e){G(Object(u.a)({isOpen:!0},e))},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===n._id}));S.changeLikeCardStatus(e._id,t).then((function(t){var n=M.map((function(n){return n._id===e._id?t:n}));z(n)})).catch((function(e){return console.log("Error: ".concat(e))}))},onCardDelete:function(e){S.removeCard(e._id).then((function(t){var n=M.filter((function(t){return t._id===e._id?null:t}));z(n)})).catch((function(e){return console.log("Error: ".concat(e))}))},cards:M,loggedIn:Q}),Object(m.jsx)(j.b,{path:"/sign-in",children:Object(m.jsx)(E,{onLogin:function(e,t){return P.authorize(e,t).then((function(t){localStorage.setItem("jwt",t.token),$(e),W(!0),se.push("/")})).catch((function(e){console.error(e),ie(!1),ae(!0)}))}})}),Object(m.jsx)(j.b,{path:"/sign-up",children:Object(m.jsx)(L,{onRegister:function(e,t){P.register(e,t).then((function(){se.push("/sign-in"),ie(!0),ae(!0)})).catch((function(e){console.error(e),ie(!1),ae(!0)}))}})}),Object(m.jsxs)(j.b,{children:[" ",Q?Object(m.jsx)(j.a,{to:"/"}):Object(m.jsx)(j.a,{to:"/sign-in"})]})]}),Object(m.jsx)(_,{text:"2021 mesto lisenkin"}),Object(m.jsx)(v,{isOpen:d,onClose:ue,onUpdateUser:function(e){var t=e.name,n=e.about;S.setUserInfo({name:t,about:n}).then((function(e){c(e),ue()})).catch((function(e){return console.log("Error: ".concat(e))}))}}),Object(m.jsx)(C,{isOpen:y,onClose:ue,onAddPlace:function(e){var t=e.name,n=e.link;S.setCard({name:t,link:n}).then((function(e){z([e].concat(Object(i.a)(M))),ue()})).catch((function(e){return console.log("Error: ".concat(e))}))}}),Object(m.jsx)(N,{isOpen:T,onClose:ue,onUpdateAvatar:function(e){S.editUserAvatar(e).then((function(t){c(e),ue()})).catch((function(e){return console.log("Error: ".concat(e))}))}}),Object(m.jsx)(x,{name:"popup-remove-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",textButton:"\u0414\u0430"}),Object(m.jsx)(g,{isOpen:F,card:F,onClose:ue}),Object(m.jsx)(D,{isOpen:ne,success:re,onClose:ue})]})})},I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),c(e),o(e)}))};o.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(r.a,{children:Object(m.jsx)(A,{})})}),document.getElementById("root")),I()}},[[36,1,2]]]);
//# sourceMappingURL=main.22149ce2.chunk.js.map